@model AppUser

@{
    ViewData["Title"] = "Profil Düzenle";
}

<div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-8 px-4">
    <div class="max-w-2xl mx-auto">
        <div class="bg-white rounded-lg shadow-lg p-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-8">Profil Bilgilerinizi Düzenleyin</h1>

            @if (TempData["SuccessMessage"] != null)
            {
                <div class="mb-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg">
                    @TempData["SuccessMessage"]
                </div>
            }

            <form method="post" enctype="multipart/form-data" class="space-y-6">
                <div asp-validation-summary="All" class="text-red-600 mb-3"></div>
                <!-- Profile Picture Upload -->
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-indigo-400 transition">
                    <input type="file" name="profileImage" id="profileImage" accept="image/*" class="hidden" onchange="previewImage(event)">
                    <label for="profileImage" class="cursor-pointer">
                        @if (!string.IsNullOrEmpty(Model.ProfileImageUrl))
                        {
                            <img id="preview" src="@Model.ProfileImageUrl" alt="Profil Resmi" class="mx-auto mb-4 h-32 w-32 rounded-full object-cover">
                        }
                        else
                        {
                            <div id="preview" class="mx-auto mb-4 h-32 w-32 rounded-full bg-indigo-100 flex items-center justify-center">
                                <svg class="w-16 h-16 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                        }
                        <p class="text-gray-600 font-medium">Profil Resmi Yükleyin</p>
                        <p class="text-sm text-gray-500">Resim seçmek için tıklayın</p>
                    </label>
                </div>
                @{ 
                    var imgErrors = ViewData.ModelState["profileImage"]?.Errors; 
                    if (imgErrors != null && imgErrors.Count > 0)
                    {
                        <div class="text-red-600 text-sm mt-2">@imgErrors[0].ErrorMessage</div>
                    }
                }

                <!-- First Name -->
                <div>
                    <label for="FirstName" class="block text-sm font-medium text-gray-700 mb-2">Ad</label>
                    <input type="text" id="FirstName" name="FirstName" value="@Model.FirstName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                </div>

                <!-- Last Name -->
                <div>
                    <label for="LastName" class="block text-sm font-medium text-gray-700 mb-2">Soyadı</label>
                    <input type="text" id="LastName" name="LastName" value="@Model.LastName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                </div>

                <!-- Email -->
                <div>
                    <label for="Email" class="block text-sm font-medium text-gray-700 mb-2">E-Posta</label>
                    <input type="email" id="Email" name="Email" value="@Model.Email" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                </div>

                <!-- Phone Number -->
                <div>
                    <label for="PhoneNumber" class="block text-sm font-medium text-gray-700 mb-2">Telefon Numarası (İsteğe Bağlı)</label>
                    <input type="tel" id="PhoneNumber" name="PhoneNumber" value="@(Model.PhoneNumber ?? "")" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                </div>

                <!-- Biography -->
                <div>
                    <label for="Biography" class="block text-sm font-medium text-gray-700 mb-2">Biyografi</label>
                    <textarea id="Biography" name="Biography" rows="4" placeholder="Kendiniz hakkında yazınız..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">@(Model.Biography ?? "")</textarea>
                    <p class="text-sm text-gray-500 mt-1">Maksimum 500 karakter</p>
                </div>

                <!-- Buttons -->
                <div class="flex gap-4">
                    <button type="submit" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-3 px-4 rounded-lg transition">
                        Kaydet
                    </button>
                    <a href="/UserProfile/View" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-900 font-medium py-3 px-4 rounded-lg text-center transition">
                        İptal
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    function previewImage(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                const preview = document.getElementById('preview');
                preview.innerHTML = `<img src="${e.target.result}" alt="Preview" class="w-full h-full object-cover rounded-full">`;
            };
            reader.readAsDataURL(file);
        }
    }
</script>
