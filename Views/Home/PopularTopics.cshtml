@{
    ViewData["Title"] = "Popüler Konular";
}

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Header -->
    <div class="mb-8 animate-slide-down">
        <div class="flex items-center justify-between mb-6">
            <div>
                <h1 class="text-4xl font-bold text-gray-900 mb-2">
                    <i class="fas fa-fire text-orange-500 mr-2"></i>Popüler Konular
                </h1>
                <p class="text-gray-600">En çok tartışılan ve görüntülenen konuların listesi</p>
            </div>
            <div class="text-right">
                <p class="text-3xl font-bold text-indigo-600">@ViewBag.TotalCount</p>
                <p class="text-gray-500">Toplam Konu</p>
            </div>
        </div>

        <!-- Sıralama Seçenekleri -->
        <div class="flex gap-3 flex-wrap">
            <a asp-controller="Home" asp-action="PopularTopics" asp-route-sortBy="posts" 
               class="px-4 py-2 rounded-lg font-semibold transition-all @(ViewBag.SortBy == "posts" ? "bg-indigo-600 text-white" : "bg-gray-200 text-gray-700 hover:bg-gray-300")">
                <i class="fas fa-comments mr-1"></i>En Çok Yorum
            </a>
            <a asp-controller="Home" asp-action="PopularTopics" asp-route-sortBy="views" 
               class="px-4 py-2 rounded-lg font-semibold transition-all @(ViewBag.SortBy == "views" ? "bg-indigo-600 text-white" : "bg-gray-200 text-gray-700 hover:bg-gray-300")">
                <i class="fas fa-eye mr-1"></i>En Çok Görüntü
            </a>
            <a asp-controller="Home" asp-action="PopularTopics" asp-route-sortBy="recent" 
               class="px-4 py-2 rounded-lg font-semibold transition-all @(ViewBag.SortBy == "recent" ? "bg-indigo-600 text-white" : "bg-gray-200 text-gray-700 hover:bg-gray-300")">
                <i class="fas fa-clock mr-1"></i>En Yeni
            </a>
        </div>
    </div>

    <!-- Topics List -->
    <div class="space-y-4">
        @if (ViewBag.Topics != null && ViewBag.Topics.Count > 0)
        {
            @foreach (var topic in ViewBag.Topics)
            {
                <div class="bg-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 p-6 animate-fade-in border-l-4 border-indigo-600">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-sm font-semibold">
                                    @topic.Category
                                </span>
                            </div>
                            
                            <a asp-controller="Forum" asp-action="Details" asp-route-id="@topic.Id" 
                               class="text-2xl font-bold text-gray-900 hover:text-indigo-600 transition-colors block mb-3">
                                @topic.Title
                            </a>

                            <div class="flex flex-wrap gap-4 text-sm text-gray-600">
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-user-circle text-indigo-600"></i>
                                    <a asp-controller="UserProfile" asp-action="View" asp-route-id="@topic.AuthorId" 
                                       class="hover:text-indigo-600">
                                        @topic.Author
                                    </a>
                                </div>
                                <div class="flex items-center gap-2">
                                    <i class="fas fa-calendar text-blue-600"></i>
                                    <span>@topic.CreatedAt.ToString("dd.MM.yyyy HH:mm")</span>
                                </div>
                            </div>
                        </div>

                        <!-- Stats -->
                        <div class="ml-6 flex flex-col gap-3 text-center min-w-max">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <p class="text-2xl font-bold text-blue-600">@topic.PostCount</p>
                                <p class="text-xs text-blue-600">
                                    <i class="fas fa-comments mr-1"></i>Yorum
                                </p>
                            </div>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <p class="text-2xl font-bold text-purple-600">@topic.ViewCount</p>
                                <p class="text-xs text-purple-600">
                                    <i class="fas fa-eye mr-1"></i>Görüntü
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Hover Action -->
                    <div class="mt-4 pt-4 border-t border-gray-200 flex justify-end">
                        <a asp-controller="Forum" asp-action="Details" asp-route-id="@topic.Id" 
                           class="inline-flex items-center gap-2 bg-indigo-600 text-white hover:bg-indigo-700 px-4 py-2 rounded-lg transition-all transform hover:scale-105">
                            <i class="fas fa-arrow-right"></i>Konuyu Aç
                        </a>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="text-center py-16 bg-gray-50 rounded-lg">
                <i class="fas fa-inbox text-6xl text-gray-300 mb-4 block"></i>
                <p class="text-2xl text-gray-600 mb-2">Henüz Konu Yok</p>
                <p class="text-gray-500 mb-6">Forumlarda tartışmaya başlamak için yeni bir konu açın</p>
                <a asp-controller="Forum" asp-action="Create" 
                   class="inline-block bg-indigo-600 text-white hover:bg-indigo-700 px-6 py-3 rounded-lg font-semibold transition-all">
                    <i class="fas fa-plus mr-2"></i>Yeni Konu Açı
                </a>
            </div>
        }
    </div>

    <!-- Pagination -->
    @if (ViewBag.TotalPages > 1)
    {
        <div class="mt-12 flex items-center justify-center gap-2">
            @if (ViewBag.CurrentPage > 1)
            {
                <a asp-controller="Home" asp-action="PopularTopics" 
                   asp-route-page="1" asp-route-sortBy="@ViewBag.SortBy"
                   class="px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-gray-700 transition-all">
                    <i class="fas fa-chevron-left mr-1"></i>İlk Sayfa
                </a>
            }

            @for (int i = Math.Max(1, ViewBag.CurrentPage - 2); i <= Math.Min(ViewBag.TotalPages, ViewBag.CurrentPage + 2); i++)
            {
                @if (i == ViewBag.CurrentPage)
                {
                    <span class="px-4 py-2 rounded-lg bg-indigo-600 text-white font-bold">@i</span>
                }
                else
                {
                    <a asp-controller="Home" asp-action="PopularTopics" 
                       asp-route-page="@i" asp-route-sortBy="@ViewBag.SortBy"
                       class="px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-gray-700 transition-all">
                        @i
                    </a>
                }
            }

            @if (ViewBag.CurrentPage < ViewBag.TotalPages)
            {
                <a asp-controller="Home" asp-action="PopularTopics" 
                   asp-route-page="@ViewBag.TotalPages" asp-route-sortBy="@ViewBag.SortBy"
                   class="px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-gray-700 transition-all">
                    Son Sayfa<i class="fas fa-chevron-right ml-1"></i>
                </a>
            }
        </div>
    }
</div>
